{% extends "base.html" %}

{% set TOOLTIP_TITLE = _('To select more items, hold the Ctrl key while click on them') %}

{% block content %}
    <div class="container" style="background-color:WhiteSmoke;overflow-y:auto;">
        <form action="" method="post" novalidate>
            <div class="row">
                <div class="col-12">
                    <h5>{{ _('Please, select below the informations you wish to plot') }}</h5>
                </div>
            </div>
            <div class="row">
                <div class="col-md-3">
                    <div class="row">
                        <div class="col-md-12">
                            {{ form.hidden_tag() }}
                            <p><span  style="font-style: italic;text-decoration: underline;">{{_('Kind of information') }}</span>
                               {{_('to display for every country or continent') }}.
                               <a data-toggle="collapse" href="#explainInfo"><span><img src="/static/images/bootstrap-icons-1.0.0/question-circle.svg" alt="" width="16" height="16" title="more_info"></span></a>
                               
                            </p>
                            <div class="collapse" id="explainInfo">
                                <p>
                                {% for field in all_fields.keys() %}
                                    <span style="font-weight: bold;">{{field}}</span> {{ all_fields[field]['explanation'] }}{% if loop.index != loop.length %};<br>{% endif%}
                                {% endfor %}.
                                </p>
                                
                            </div>
                            <p>
                                {# {{ form.fields.label }}<br> #}
                                {{ form.fields(size=all_fields.keys()|length, **{ 'data-toggle': 'tooltip',
                                                                                  'data-placement': 'top',
                                                                                  'data-delay': 1500,
                                                                                  'title': TOOLTIP_TITLE,
                                                                                  'style': 'scrollbar-width: none;',
                                                                                }
                                               )
                                }}<br>
                                {% for error in form.fields.errors %}
                                <span style="color: red;">[{{ error }}]</span>
                                {% endfor %}
                            </p>
                        </div>
                    </div>
                    <hr>
                    <div class="row">
                        <div class="col-md-12">
                            <p><span  style="font-style: italic;text-decoration: underline;">{{_('Time interval') }}</span>
                               {{_('to show') }}.
                               <a data-toggle="collapse" href="#explainDate"><span><img src="/static/images/bootstrap-icons-1.0.0/question-circle.svg" alt="" width="16" height="16" title="more_info"></span></a>
                            </p>
                            <div class="collapse" id="explainDate">
                                <p>
                                    <span style="font-weight: bold;">first</span> {{ _('is the initial day to plot') }},
                                    <br>
                                    <span style="font-weight: bold;">last</span>   {{ _('is the final day to plot') }}.
                                    <br>
                                    {{_('Date format is year-month-day: yyyy-mm-dd')}}.
                                    <br>
                                    <b>{{_('Warning')}}</b>: {{_('if you select a first>minimum_available_date, all data between the minimum available and your choice will be ignored. Accordingly showed data will start from zero')}}.
                                </p>
                            </div>
                            <p>
                                {{ form.first.label }}: <span style="position: absolute; left:60px;">{{ form.first }}</span><br>
                                {% for error in form.first.errors %}
                                    <span style="color: red;">[{{ error }}]</span>
                                {% endfor %}<br>
                                {{ form.last.label }}: <span style="position: absolute; left:60px;">{{ form.last }}</span><br>
                                {% for error in form.last.errors %}
                                    <span style="color: red;">[{{ error }}]</span>
                                {% endfor %}
                                
                            </p>
                        </div>
                    </div>
                    <hr>
                    <div class="row">
                        <div class="col-md-12">
                            <p><span  style="font-style: italic;text-decoration: underline;">{{_('Type of geographical entity')}}</span> {{_('to select') }}.
                               <a data-toggle="collapse" href="#explainGeo"><span><img src="/static/images/bootstrap-icons-1.0.0/question-circle.svg" alt="" width="16" height="16" title="more_info"></span></a>
                            </p>
                        <div class="collapse" id="explainGeo">
                            <p>
                            <span style="font-weight: bold;">nations</span>    {{ _('enables the box to select from countries and territories; while') }},
                            <span style="font-weight: bold;">continents</span> {{ _('enables the box to select what continent(s) to display') }}.
                            <br>
                            {{_('Continents definitions (so: what countries are in every continent) are from United Nations and/or Wikipedia')}}.
                            <br>
                            {{_('The population data in the database are from the World Bank')}}.
                            </p>
                        </div>
                            <p>
                                {# {{ form.fields.label }}<br> #}
                                {{ form.contest(**{ 'id':    'contest',
                                                    'style': 'list-style-type:none;padding:0;margin:0;',
                                                  }
                                               ) }}<br>
                                {% for error in form.contest.errors %}
                                <span style="color: red;">[{{ error }}]</span>
                                {% endfor %}
                            </p>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <p> <span  style="font-style: italic;text-decoration: underline;">{{ _('Countries and territories') }}</span></p>
                    <p>
                        {# {{ form.countries.label }}<br> #}
                        {{ form.countries(size=22, **{ 'id':       'nations',
                                                       'data-toggle':    'tooltip',
                                                       'data-delay': 1500,
                                                       'title':    TOOLTIP_TITLE
                                                     }
                                         ) }}<br>
                        {% for error in form.countries.errors %}
                        <span style="color: red;">[{{ error }}]</span>
                        {% endfor %}
                    </p>
                </div>
                <div class="col-md-3">
                    <p> <span  style="font-style: italic;text-decoration: underline;">{{ _('Continents') }}</span></p>
                    <p>
                        {# {{ form.continents.label }}<br> #}
                        {{ form.continents(size=continents|length, **{ 'id':       'continents',
                                                                       'disabled': 'true',
                                                                       'data-toggle':    'tooltip',
                                                                       'data-delay': 1500,
                                                                       'title': TOOLTIP_TITLE,
                                                                       'style': 'scrollbar-width: none;',
                                                                     }
                                          ) }}<br>
                        {% for error in form.continents.errors %}
                        <span style="color: red;">[{{ error }}]</span>
                        {% endfor %}
                    </p>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <p>{{ form.submit(**{'class': 'btn btn-primary'}) }}</p>
                </div>
            </div>
        </form>
    </div>
{% endblock %}


{% block javascript %}
    <script>
        $(function (){$('[data-toggle="tooltip"]').tooltip()} )</script>
    <script>
        $(function() {
                var in_contest = $("input[name=contest]:checked").val();
                if(in_contest=='nations'){
                    document.getElementById('nations').disabled = false;
                    document.getElementById('continents').selectedIndex = -1
                    document.getElementById('continents').disabled = true;
                    }
                else if(in_contest=='continents'){
                    document.getElementById('nations').selectedIndex = -1;
                    document.getElementById('nations').disabled = true;
                    document.getElementById('continents').disabled = false;
                    }
                }) 
    </script>
    <script>
        $(function() {
            $('#contest li').click( function() {
                var in_contest = $("input[name=contest]:checked").val();
                console.log(in_contest);
                if(in_contest=='nations'){
                    document.getElementById('nations').disabled = false;
                    document.getElementById('continents').selectedIndex = -1
                    document.getElementById('continents').disabled = true;
                    }
                else if(in_contest=='continents'){
                    document.getElementById('nations').selectedIndex = -1;
                    document.getElementById('nations').disabled = true;
                    document.getElementById('continents').disabled = false;
                    }
                }) })
    </script>
{% endblock %}
